function [Lo]=montar_Lo(INS, dado, nimg, esc, Lx, Ly, Lz, r, b, f)

%%X,Y,Z,omega,phi,kappa, nome_foto
% INS=inercial;
%%Foto_X, Foto_Y, Nro_plano, nx, ny, nz, d, nome_foto
% pts_img=dado;
INSx=INS(:,1);
INSy=INS(:,2);
INSz=INS(:,3);

nx = dado(:,4);
ny = dado(:,5);
nz = dado(:,6);

foto_x = dado(:,1)
foto_y = dado(:,2)

for i=1:nimg
  if(i==1)
    Lo(1)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x(i)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x(i)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x(i)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y(i)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y(i)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y(i)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x(i)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x(i)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x(i)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y(i)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y(i)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y(i)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x(i)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x(i)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x(i)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y(i)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y(i)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y(i)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo(2)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x(i+1)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x(i+1)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x(i+1)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y(i+1)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y(i+1)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y(i+1)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x(i+1)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x(i+1)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x(i+1)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y(i+1)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y(i+1)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y(i+1)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x(i+1)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x(i+1)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x(i+1)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y(i+1)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y(i+1)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y(i+1)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo(3)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x(i+2)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x(i+2)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x(i+2)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y(i+2)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y(i+2)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y(i+2)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x(i+2)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x(i+2)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x(i+2)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y(i+2)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y(i+2)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y(i+2)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x(i+2)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x(i+2)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x(i+2)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y(i+2)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y(i+2)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y(i+2)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
  elseif (i==nimg)
    Lo((i-1)*6-2)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6-2)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6-1)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6-1)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
  else
    Lo((i-1)*6-2)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6-2)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6-2)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6-2)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6-1)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6-1)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6-1)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6-1)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6+1)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6+1)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6+1)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6+1)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6+1)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6+1)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6+1)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6+1)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6+1)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6+1)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6+1)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6+1)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6+1)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6+1)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6+1)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6+1)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6+1)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6+1)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6+1)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6+2)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6+2)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6+2)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6+2)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6+2)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6+2)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6+2)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6+2)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6+2)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6+2)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6+2)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6+2)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6+2)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6+2)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6+2)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6+2)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6+2)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6+2)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6+2)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
    Lo((i-1)*6+3)=nx(i)*INSx(i)+ny(i)*INSy(i)+nz(i)*INSz(i)+nx(i)*r(1,1,i)*Lx+nx(i)*r(1,2,i)*Ly+nx(i)*r(1,3,i)*Lz+ny(i)*r(2,1,i)*Lx+ny(i)*r(2,2,i)*Ly+ny(i)*r(2,3,i)*Lz+nz(i)*r(3,1,i)*Lx+nz(i)*r(3,2,i)*Ly+nz(i)*r(3,3,i)*Lz+esc*foto_x((i-1)*6+3)*nx(i)*r(1,1,i)*b(1,1)+esc*foto_x((i-1)*6+3)*nx(i)*r(1,2,i)*b(2,1)+esc*foto_x((i-1)*6+3)*nx(i)*r(1,3,i)*b(3,1)+esc*foto_y((i-1)*6+3)*nx(i)*r(1,1,i)*b(1,2)+esc*foto_y((i-1)*6+3)*nx(i)*r(1,2,i)*b(2,2)+esc*foto_y((i-1)*6+3)*nx(i)*r(1,3,i)*b(3,2)-esc*f*nx(i)*r(1,1,i)*b(1,3)-esc*f*nx(i)*r(1,2,i)*b(2,3)-esc*f*nx(i)*r(1,3,i)*b(3,3)+esc*foto_x((i-1)*6+3)*ny(i)*r(2,1,i)*b(1,1)+esc*foto_x((i-1)*6+3)*ny(i)*r(2,2,i)*b(2,1)+esc*foto_x((i-1)*6+3)*ny(i)*r(2,3,i)*b(3,1)+esc*foto_y((i-1)*6+3)*ny(i)*r(2,1,i)*b(1,2)+esc*foto_y((i-1)*6+3)*ny(i)*r(2,2,i)*b(2,2)+esc*foto_y((i-1)*6+3)*ny(i)*r(2,3,i)*b(3,2)-esc*f*ny(i)*r(2,1,i)*b(1,3)-esc*f*ny(i)*r(2,2,i)*b(2,3)-esc*f*ny(i)*r(2,3,i)*b(3,3)+esc*foto_x((i-1)*6+3)*nz(i)*r(3,1,i)*b(1,1)+esc*foto_x((i-1)*6+3)*nz(i)*r(3,2,i)*b(2,1)+esc*foto_x((i-1)*6+3)*nz(i)*r(3,3,i)*b(3,1)+esc*foto_y((i-1)*6+3)*nz(i)*r(3,1,i)*b(1,2)+esc*foto_y((i-1)*6+3)*nz(i)*r(3,2,i)*b(2,2)+esc*foto_y((i-1)*6+3)*nz(i)*r(3,3,i)*b(3,2)-esc*f*nz(i)*r(3,1,i)*b(1,3)-esc*f*nz(i)*r(3,2,i)*b(2,3)-esc*f*nz(i)*r(3,3,i)*b(3,3);
  end
end

Lo=Lo';